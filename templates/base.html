<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}首页{% endblock %}</title>
    <!-- Bootstrap 5 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
            rel="stylesheet">
    <link rel="icon" href="{{ url_for('static', filename='blog.svg') }}" type="image/x-icon">

    {% block style %}
        <style>
            /* 确保下拉菜单在最上层 */
            .dropdown-menu {
                z-index: 1060 !important; /* 提高层级，确保显示在最上层 */
            }

            /* 确保导航栏容器不会裁剪下拉菜单 */
            .navbar, .container-fluid {
                overflow: visible !important; /* 强制覆盖可能存在的 overflow:hidden */
            }

            html, body {
                height: 100%; /* 确保 html 和 body 占据整个视窗高度 */
                margin: 0;
            }

            .wrapper {
                display: flex;
                flex-direction: column;
                min-height: 100vh; /* 至少占据整个视窗的高度 */
                position: relative; /* 确保定位上下文清晰 */
            }

            .content-wrap {
                flex: 1 0 auto; /* 让内容区域尽可能扩展以填充剩余空间 */
            }

            .glass-effect {
                backdrop-filter: blur(10px); /* 应用模糊效果 */
                background-color: rgba(255, 255, 255, 0.7); /* 半透明白色背景 */
                border-radius: 8px;
            }

            body {
                background-image: url("{{ url_for('static', filename='imgs/bgim.png') }}");
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
                background-repeat: no-repeat;
                background-color: #000;
            }

            footer {
                flex-shrink: 0;
                border-top: 1px solid #dee2e6;
            }

            /* 可选：给整个内容区加一个遮罩层 */
            body::before {
                content: "";
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.2);
                z-index: -1;
            }

            /* 避免内容容器创建过强的层叠上下文 */
            .content-wrap .container.glass-effect {
                position: relative;
                z-index: auto;
            }
        </style>
    {% endblock %}
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="{{ url_for('static', filename='tinymce/tinymce.min.js') }}"></script>
    <script>
        tinymce.init({
            selector: '#content',
            height: 400,
            menubar: false,
            plugins: [
                'advlist autolink lists link image charmap print preview anchor',
                'searchreplace visualblocks code',
                'insertdatetime media table paste code help wordcount'
            ],
            toolbar: 'undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | code | help',
            branding: false,  // 隐藏 "Powered by Tiny"
            promotion: false  // 禁用推广提示（TinyMCE 6+）
        });
    </script>
</head>
<body>
<div class="wrapper">
    <!-- 顶部导航栏目 -->
    {% block navbar %}
        <nav class="navbar navbar-expand-lg glass-effect" style="position: relative; z-index: 1030;">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">Vimin_blog</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll"
                        aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarScroll">
                    <!-- 左侧导航项 -->
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="/index">首页</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('user.aboutme') }}">关于我</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('user.allphoto') }}">图片大合集</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                               aria-expanded="false">
                                文章分类
                            </a>
                            <ul class="dropdown-menu">
                                {% for type in g.article_types %}
                                    <li><a href="{{ url_for('user.index') }}?articletype={{ type.id }}"
                                           class="dropdown-item">{{ type.typename }}</a></li>
                                {% endfor %}
                                {#                                <li><a class="dropdown-item" href="#">Action</a></li>#}
                                {#                                <li><a class="dropdown-item" href="#">Another action</a></li>#}
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">其它</a></li>
                            </ul>
                        </li>
                        {% if users %}
                            <li class="nav-item">
                                <a class="nav-link" href="#">我的相册</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">留言板</a>
                            </li>
                        {% endif %}
                    </ul>

                    <!-- 中间搜索框 -->
                    <form action="{{ url_for('article.searcharticle') }}" class="d-flex mx-auto" style="max-width: 300px;" role="search">
                        <input class="form-control me-2" name="kw" type="search" placeholder="搜你想搜" aria-label="Search">
                        <button class="btn btn-outline-success" type="submit"
                                style="white-space: nowrap; min-width: 60px;">
                            搜索
                        </button>
                    </form>

                    <!-- 右侧登录/用户信息 -->
                    <div class="ms-auto" style="margin-right: 40px">
                        <!-- 登录后用户信息部分 -->
                        {#                        {% if username %}#}
                        {% if g.userme %}
                            <ul class="navbar-nav">
                                <img src="



                                        {% if g.userme.icon %}{{ url_for('static',filename=g.userme.icon) }}{% else %}{{ url_for('static',filename='imgs/touxiang.png') }}{% endif %}"
                                     alt="" style="border-radius: 100%;width: 40px;height: 40px ; margin-right: 10px">

                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                                       aria-expanded="false">
                                        您好,{{ g.userme.username }}
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item"
                                               href="{{ url_for('user.usercenter') }}">用户中心</a></li>
                                        <li><a class="dropdown-item"
                                               href="{{ url_for('article.publish') }}">发表文章</a></li>
                                        <li><a class="dropdown-item"
                                               href="{{ url_for('user.upphoto') }}">相册管理</a></li>
                                        <li><a class="dropdown-item"
                                               href="{{ url_for('article.manar') }}">文章管理</a></li>
                                        <li>
                                            <hr class="dropdown-divider">
                                        </li>
                                        <li><a class="dropdown-item" href="/logout">退出</a></li>
                                    </ul>
                                </li>
                            </ul>
                        {% else %}
                            <ul class="navbar-nav">
                                <li class="nav-item"><a class="nav-link" href="/login">未登录点击登陆</a></li>
                            </ul>
                        {% endif %}
                    </div>
                </div>
            </div>
        </nav>
    {% endblock %}

    <div class="content-wrap">
        {% block content %}
            <div class="container mt-4 glass-effect">
                {% block page_content %}{% endblock %}
            </div>
        {% endblock %}
    </div>

    {% block footer %}
        <footer class="text-center py-3 glass-effect">
            <p class="mb-0">&copy; 版权所有，侵权必究</p>
        </footer>
    {% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% block myjs %}
    <!-- Bootstrap 5 JS Bundle -->


{% endblock %}
</body>
</html>